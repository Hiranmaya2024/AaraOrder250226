<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Aaradhya Pharma Order App</title>

<style>
body{font-family:Arial;margin:0;background:#f5f5f5}

/* SCREENS */
.screen{display:none;padding:15px}
.active{display:block}

/* WELCOME */
#welcome{
display:flex;align-items:center;justify-content:center;
height:100vh;font-size:22px;font-weight:bold;
background:#0a7cff;color:white;text-align:center;cursor:pointer
}

/* COMPANY GRID */
.company{
background:white;padding:15px;margin:8px 0;border-radius:10px;
box-shadow:0 2px 5px rgba(0,0,0,.1);
font-weight:bold;cursor:pointer
}

/* PRODUCT CARD */
.card{
background:white;border-radius:12px;padding:12px;margin:10px 0;
box-shadow:0 2px 6px rgba(0,0,0,.12)
}
.row{display:flex;justify-content:space-between;align-items:center}
.qty{
display:flex;gap:8px;align-items:center
}
button{
background:#0a7cff;color:white;border:none;
padding:8px 14px;border-radius:8px;font-weight:bold
}
button:active{transform:scale(.95)}
.place{width:100%;margin-top:15px;font-size:16px}

/* SUMMARY */
.summary{background:white;padding:12px;border-radius:10px;margin:8px 0}

</style>
</head>

<body>

<!-- WELCOME -->
<div id="welcome" class="active">
Welcome To Aaradhya Pharmaceuticals<br/>Tap Anywhere
</div>

<!-- COMPANY SCREEN -->
<div id="companyScreen" class="screen">
<h3>Select Company</h3>
<div id="companyList"></div>
</div>

<!-- PRODUCT SCREEN -->
<div id="productScreen" class="screen">
<h3 id="companyTitle"></h3>
<div id="productList"></div>
<button class="place" onclick="showSummary()">Place Order</button>
</div>

<!-- SUMMARY SCREEN -->
<div id="summaryScreen" class="screen">
<h3>Order Summary</h3>
<div id="summary"></div>
<button class="place" onclick="shareWhatsApp()">Share on WhatsApp</button>
</div>

<script>
const csvUrl="https://docs.google.com/spreadsheets/d/e/2PACX-1vRV-mdlstMlh93FOZn0udO4eCUyryl_pDziljwksKkWGVdxE2LH8excr6D-cABN61O-JrFigpecb42i/pub?gid=0&single=true&output=csv";

let data=[],cart={},selectedCompany="";

/* WELCOME AUTO NEXT */
setTimeout(()=>showCompany(),5000)
document.getElementById("welcome").onclick=showCompany

function showCompany(){
switchScreen("companyScreen")
loadCSV()
}

/* SCREEN SWITCH */
function switchScreen(id){
document.querySelectorAll(".screen,#welcome").forEach(s=>s.classList.remove("active"))
document.getElementById(id).classList.add("active")
}

/* LOAD CSV */
async function loadCSV(){
const res=await fetch(csvUrl)
const text=await res.text()
const rows=text.split("\n").slice(1)

data=rows.map(r=>{
let c=r.split(",")
return{
company:c[0],
name:c[1],
pack:c[2],
rate:c[3],
mrp:c[4],
tax:c[5],
composition:c[6],
scheme:c[7]
}
})

showCompanies()
}

/* SHOW COMPANIES */
function showCompanies(){
let companies=[...new Set(data.map(d=>d.company))]
let html=""
companies.forEach(c=>{
html+=`<div class="company" onclick="showProducts('${c}')">${c}</div>`
})
document.getElementById("companyList").innerHTML=html
}

/* SHOW PRODUCTS */
function showProducts(company){
selectedCompany=company
switchScreen("productScreen")
document.getElementById("companyTitle").innerText=company

let items=data.filter(d=>d.company===company)
let html=""

items.forEach((item,i)=>{
html+=`
<div class="card">
<b>${item.name}</b><br>
${item.pack}<br>
MRP: ₹${item.mrp} | Rate: ₹${item.rate}

<div class="row">
<div class="qty">
<button onclick="changeQty('${item.name}',-1)">-</button>
<span id="q_${item.name}">0</span>
<button onclick="changeQty('${item.name}',1)">+</button>
</div>
</div>
</div>`
})

document.getElementById("productList").innerHTML=html
}

/* QTY CHANGE */
function changeQty(name,val){
if(!cart[name]) cart[name]=0
cart[name]+=val
if(cart[name]<0) cart[name]=0
document.getElementById("q_"+name).innerText=cart[name]
}

/* SUMMARY */
function showSummary(){
switchScreen("summaryScreen")
let html="",total=0

for(let name in cart){
if(cart[name]>0){
let item=data.find(d=>d.name===name)
let value=cart[name]*item.rate
total+=value
html+=`<div class="summary">
${name} x ${cart[name]} = ₹${value}
</div>`
}
}

html+=`<h3>Total: ₹${total}</h3>`
document.getElementById("summary").innerHTML=html
}

/* WHATSAPP SHARE */
function shareWhatsApp(){
let text="Order - Aaradhya Pharmaceuticals%0A"
let total=0

for(let name in cart){
if(cart[name]>0){
let item=data.find(d=>d.name===name)
let value=cart[name]*item.rate
total+=value
text+=`${name} x ${cart[name]} = ₹${value}%0A`
}
}
text+=`Total = ₹${total}`

window.open(`https://wa.me/?text=${text}`)
}
</script>

</body>
</html>
